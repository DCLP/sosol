<script>
function commentChanged(e)
{

  <!-- don't care what key, just check that the comment has info -->
  var comment_area = document.getElementById("comment");
  var vote_button = document.getElementById("vote_button");  
  var commentText = comment_area.value;
 
  commentText = commentText.replace(/^\s+|\s+$/g, '');
  
  if (commentText == "")
  {
    vote_button.disabled = true;
   
  }
  else
  {
    vote_button.disabled = false;
  }
}
</script>



<h2><%= link_to @article.master_article.title, url_for(@article.master_article) %></h2>
by <%= @article.master_article.user.name %>
<%= render :partial => @article.get_category_obj()  %>


<h3>Comments</h3>
<div class="review_comments">
  <% @article.comments.each do |comment | %>
    <%= render :partial => comment %>
    <br />
  <% end %>
</div>

<% user_has_voted = false %>
<% board = @article.board %>


<div class = "board_tally">

<h4><%= board.title %> Votes</h4>
<% users = board.users %>
<% users.each do |user| %>
  <strong><%= user.name %></strong>
  <% vote = @article.votes.find_by_user_id (user.id) %>
  <% if vote %>
    <%= vote.choice %>
  <% else %>
    <%= "?" %>
  <% end %>
  <br />
<% end %>
</div>

<!--
<ul>
<% @article.votes.each do |vote| %>
  
  <li>
	  <%= vote.choice %> 
	  <%= vote.user.name %>
	  <% if vote.user.name == @current_user.name %>
		<% user_has_voted = true %>
	  <% end %>
  </li>
  
<% end %>
</ul>
-->

<% if !user_has_voted %>
	<% form_for :vote, @vote, :url => { :action => "vote", :id => @article.id }  do |f| %>



 <%= text_area_tag( :comment, "",:rows => 5, :cols => 80, :onkeyup => "commentChanged(event)") %>
  <br />
  
 
<br />
		<% board.decrees.each do |decree| %>
		  <% decree.get_choice_array.each do |choice| %>
			<%= f.radio_button(:choice, choice) %><%= choice %>
		  <% end %>
		<% end %>
		
	
		
<br />
	<%= submit_tag("Vote", :id => "vote_button", :disabled => "true") %>
	<% end %>
<% end %>

